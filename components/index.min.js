(()=>{if(typeof ease>"u")throw new Error("This library requires Ease to be loaded first");var{warn:E,error:m,info:$}=ease.log,{config:v}=ease,p={};async function x(t,o){let i,e,s,u=[],f;return await fetch(o).then(async l=>({content:await l.text(),code:l.status})).then(({content:l,code:b})=>{if(b===404||b===0){i=document.createElement("template"),s=document.createElement("style"),v.core.debug&&(m(`Failed to load component '${t}' from ${o}`),i.innerHTML=`<div><strong>Ease Component Error:</strong> Failed to load component '${t}' from ${o}</div>`,s.innerText=":host { color: #800; padding: 1rem; }");return}ease.extensions.all.forEach(n=>{n["@easedotjs/components"]?.parseTemplate&&(l=n["@easedotjs/components"].parseTemplate(l))});let c=new DOMParser().parseFromString(l,"text/html");c.querySelector("template")?(i=c.querySelector("template"),e=c.querySelector("script:not([src])"),s=c.querySelector("style")):(i=c.createElement("template"),i.innerHTML=l,c.body.appendChild(i)),i.content.querySelectorAll('meta[name="attribute"]').forEach(n=>{let r=n.attributes.content.value;u[r]={name:r,default:n.attributes.default?.value,style:!!n.attributes.style},n.remove()})}).catch(l=>{m(`Failed to load component '${t}' from ${o}`,l)}),{template:i,script:e,style:s,attributes:u,src:o}}async function w(t){let o=t.attributes.name?.value,i=t.attributes.href?.value;C(o,i)}async function C(t,o){if(!t)return m(`Component ${linkNode} missing name attribute`);if(!o)return m(`Component '${t}' missing href`);if(!t.includes("-"))return m(`Component '${t}' must contain a hyphen`);if(p[t])return p[t].src===o?$(`Component '${t}' already exists in registry`):m(`Component '${t}' already exists in registry with a different source`,`Existing component: ${p[t].src}`,`New component: ${o}`,"This will cause the existing component to be used instead of the new component","If you are using a router or other dynamic loading, try using different namespaces for components");let i=await x(t,o);if(!i.template)return m(`Component '${t}' missing template`);p[t]=i,customElements.define(t,class extends HTMLElement{attributes={};eventListeners=[];constructor(){super();let e=p[t];if(!e)return m(`Component '${t}' not found in registry`);let s=this.attachShadow({mode:"open"});this.shadow=s;let u=e.template.content.querySelectorAll("link");if(u.forEach(w),u.forEach(f=>f.remove()),s.appendChild(e.template.content.cloneNode(!0)),e.style&&s.appendChild(e.style.cloneNode(!0)),e.script){let f=e.script.textContent,l=new Blob([f],{type:"text/javascript"}),b=URL.createObjectURL(l),g=[];s.querySelectorAll("[id]").forEach(a=>{g[a.id]=a}),import(b).then(a=>{if(!a.default&&!e.script.attributes["no-warn"])return E(`Component '${t}' contains script tag but does not export a default. Use the no-warn attribute on the script tag if this is the intended behavior`);if(!a.default&&e.script.attributes["no-warn"])return;let n={root:s,elements:g,get el(){return this.elements},attributes:[],get attr(){return this.attributes},extensions:{},get ext(){return this.extensions},get[v.inject.name](){return this.extensions}};v.inject.extensions.forEach(r=>{r.methods&&Object.keys(r.methods)?.forEach?.(d=>{if(r[d])return E(`Extension method '${d.name}' already exists in extensions, skipping`);n.extensions[d]=r.methods[d]}),Object.assign(n.extensions,r.objects)}),Object.keys(e.attributes).forEach(r=>{let d=e.attributes[r];this.attributes[d.name]={listeners:[],_value:this.getAttribute(d.name)||d.default,set value(h){let y=this._value;this._value=h,this.listeners.forEach(L=>L(h,y)),s.dispatchEvent(new CustomEvent("attribute-changed",{detail:{name:d.name,oldValue:y,newValue:h}}))},get value(){return this._value},watch(h){this.listeners.push(h),h(this.value,null)},unwatch(h){this.listeners=this.listeners.filter(y=>y!==h)}}}),n.attributes=this.attributes,ease.extensions.all.forEach(r=>{r["@easedotjs/components"]?.onInit&&r["@easedotjs/components"].onInit({shadow:s,args:n})}),setTimeout(()=>a.default(n))});let c={};if(Object.keys(e.attributes).forEach(a=>{let n=e.attributes[a];this.shadow.dispatchEvent(new CustomEvent("attribute-changed",{detail:{name:n,oldValue:null,newValue:this.getAttribute(n)}})),n.style&&this.getAttribute(n.name)&&(c[n.name]=this.getAttribute(n.name))}),Object.keys(c).length>0){let a=document.createElement("style"),n=":host {";Object.keys(c).forEach(r=>{n+=`--${r}: ${c[r]};`}),n+="}",a.innerHTML=n,s.appendChild(a)}}}attributeChangedCallback(e,s,u){this.attributes[e]&&(this.attributes[e].value=u)}addEventListener(e,s){this.eventListeners.push({name:e,callback:s}),this.shadow.addEventListener(e,s)}removeEventListener(e,s){this.eventListeners=this.eventListeners.filter(u=>u.name===e&&u.callback===s?(this.shadow.removeEventListener(e,s),!1):!0)}disconnectedCallback(){this.eventListeners.forEach(e=>{this.shadow.removeEventListener(e.name,e.callback)})}static get observedAttributes(){return Object.keys(p[t].attributes)}})}document.addEventListener("ease_load_component",t=>{t.detail.name&&C(t.detail.name,t.detail.href)});document.addEventListener("DOMContentLoaded",()=>{let t=document.querySelectorAll(['link[rel="component"]']);t?t.forEach(w):E("No components found")});})();
//# sourceMappingURL=index.min.js.map
