(()=>{if(typeof ease>"u")throw new Error("This library requires Ease to be loaded first");var{warn:g,error:p,info:x}=ease.log,{config:v}=ease,f={};async function $(t,s){let o,e,n,c=[],b;return await fetch(s).then(async r=>({content:await r.text(),code:r.status})).then(({content:r,code:a})=>{if(a===404||a===0){o=document.createElement("template"),n=document.createElement("style"),v.core.debug&&(p(`Failed to load component '${t}' from ${s}`),o.innerHTML=`<div><strong>Ease Component Error:</strong> Failed to load component '${t}' from ${s}</div>`,n.innerText=":host { color: #800; padding: 1rem; }");return}ease.extensions.all.forEach(i=>{i["@easedotjs/components"]?.parseTemplate&&(r=i["@easedotjs/components"].parseTemplate(r))});let u=new DOMParser().parseFromString(r,"text/html");u.querySelector("template")?(o=u.querySelector("template"),e=u.querySelector("script:not([src])"),n=u.querySelector("style")):(o=u.createElement("template"),o.innerHTML=r,u.body.appendChild(o)),o.content.querySelectorAll('meta[name="attribute"]').forEach(i=>{let l=i.attributes.content.value;c[l]={name:l,default:i.attributes.default?.value,style:!!i.attributes.style},i.remove()})}).catch(r=>{p(`Failed to load component '${t}' from ${s}`,r)}),{template:o,script:e,style:n,attributes:c,src:s}}async function C(t){let s=t.attributes.name?.value,o=t.attributes.href?.value;w(s,o)}async function w(t,s){if(!t)return p(`Component ${linkNode} missing name attribute`);if(!s)return p(`Component '${t}' missing href`);if(!t.includes("-"))return p(`Component '${t}' must contain a hyphen`);if(f[t])return f[t].src===s?x(`Component '${t}' already exists in registry`):p(`Component '${t}' already exists in registry with a different source`,`Existing component: ${f[t].src}`,`New component: ${s}`,"This will cause the existing component to be used instead of the new component","If you are using a router or other dynamic loading, try using different namespaces for components");let o=await $(t,s);if(!o.template)return p(`Component '${t}' missing template`);f[t]=o,customElements.define(t,class extends HTMLElement{attributes={};eventListeners=[];constructor(){super();let e=f[t];if(!e)return p(`Component '${t}' not found in registry`);let n=this.attachShadow({mode:"open"});this.shadow=n;let c=e.template.content.querySelectorAll("link");if(c.forEach(C),c.forEach(r=>r.remove()),n.appendChild(e.template.content.cloneNode(!0)),e.style&&n.appendChild(e.style.cloneNode(!0)),e.script){let r=e.script.textContent,a=new Blob([r],{type:"text/javascript"}),y=URL.createObjectURL(a),u=[];n.querySelectorAll("[id]").forEach(d=>{u[d.id]=d}),import(y).then(d=>{if(!d.default&&!e.script.attributes["no-warn"])return g(`Component '${t}' contains script tag but does not export a default. Use the no-warn attribute on the script tag if this is the intended behavior`);if(!d.default&&e.script.attributes["no-warn"])return;let i={root:n,elements:u,get el(){return this.elements},attributes:[],get attr(){return this.attributes},extensions:{},get ext(){return this.extensions},get[v.inject.name](){return this.extensions}};v.inject.extensions.forEach(l=>{l.methods&&Object.keys(l.methods)?.forEach?.(h=>{if(l[h])return g(`Extension method '${h.name}' already exists in extensions, skipping`);i.extensions[h]=l.methods[h]}),Object.assign(i.extensions,l.objects)}),Object.keys(e.attributes).forEach(l=>{let h=e.attributes[l];this.attributes[h.name]={listeners:[],_value:this.getAttribute(h.name)||h.default,set value(m){let E=this._value;this._value=m,this.listeners.forEach(L=>L(m,E)),n.dispatchEvent(new CustomEvent("attribute-changed",{detail:{name:h.name,oldValue:E,newValue:m}}))},get value(){return this._value},watch(m){this.listeners.push(m),m(this.value,null)},unwatch(m){this.listeners=this.listeners.filter(E=>E!==m)}}}),i.attributes=this.attributes,ease.extensions.all.forEach(l=>{l["@easedotjs/components"]?.onInit&&l["@easedotjs/components"].onInit({shadow:n,args:i})}),setTimeout(()=>d.default(i))}),Object.keys(e.attributes).forEach(d=>{let i=e.attributes[d];this.shadow.dispatchEvent(new CustomEvent("attribute-changed",{detail:{name:i,oldValue:null,newValue:this.getAttribute(i)}}))})}let b={};if(Object.keys(e.attributes).forEach(r=>{let a=e.attributes[r];a.style&&this.getAttribute(a.name)&&(b[a.name]=this.getAttribute(a.name))}),Object.keys(b).length>0){let r=document.createElement("style"),a=":host {";Object.keys(b).forEach(y=>{a+=`--${y}: ${b[y]};`}),a+="}",r.innerHTML=a,n.appendChild(r)}}attributeChangedCallback(e,n,c){this.attributes[e]&&(this.attributes[e].value=c)}addEventListener(e,n){this.eventListeners.push({name:e,callback:n}),this.shadow.addEventListener(e,n)}removeEventListener(e,n){this.eventListeners=this.eventListeners.filter(c=>c.name===e&&c.callback===n?(this.shadow.removeEventListener(e,n),!1):!0)}disconnectedCallback(){this.eventListeners.forEach(e=>{this.shadow.removeEventListener(e.name,e.callback)})}static get observedAttributes(){return Object.keys(f[t].attributes)}})}function j(t){fetch(t).then(s=>{if(s.status===404)throw g(`Failed to load component from ${t}`);return s.text()}).then(s=>{new DOMParser().parseFromString(s,"text/xml").querySelector("components").childNodes.forEach(n=>{n.nodeName==="component"&&w(n.attributes.name.value,n.attributes.href.value)})})}document.addEventListener("ease_load_component",t=>{t.detail.name&&w(t.detail.name,t.detail.href)});document.addEventListener("DOMContentLoaded",()=>{let t=document.querySelectorAll(['link[rel="component"]']);t&&t.forEach(C);let s=document.querySelectorAll(['link[rel="component-def"]']);s&&s.forEach(o=>{console.error(o),j(o.attributes.href.value)}),!t&&!s&&g("No components found in document")});})();
//# sourceMappingURL=index.min.js.map
